# MTA算法
- MTA 的全称是 Mutil-Touch Attribution（多触点归因），是指一次转化的功劳不再完全归因至用户转化前的某一个广告触点上，而是按照一定的权重分配至发生转化前被触达的多个触点上。
- DDA 的全称是 Data Driven Attribution（数据驱动的归因），是一种基于算法的多触点归因模型，主要通过算法或者模型预估来分析用户转化路径中，每个触点的存在或者顺序对转化的贡献。
## MTA/DDA 为什么好？
目前普遍使用的 last touch 归因，简单直接的将价值归给最后一次触点，这种并不精准的归因方法极有可能高估最后一次触点的价值。这会带来：  
•	客户预算向最后一次触点倾斜，但最终收益却不符合预期  
•	模型将其他触点价值低估，减少其他触点的分发，从而导致客户转化变少  
科学的 MTA/DDA 模型能够改变这种情况，公平合理的分配触点贡献，从而提升模型预估效果，为客户带来收益。
<p align="center">
  <img width="414" height="126" alt="image" src="https://github.com/user-attachments/assets/b49a6085-1a30-4c64-8a25-43540c77e4d5">
</p>

## 有哪些 MTA/DDA 算法？它们是怎么做的？
迄今为止，有五篇代表性的工作。具体如下：

<p align="center">
  <img width="414" height="102" alt="image" src="https://github.com/user-attachments/assets/22ed5e2c-653c-48c5-a386-9b77a4f8391f" />
</p>
•	Data-driven MTA: Data-driven Multi-touch Attribution Models. 2011  

•	DNAMTA: Deep Neural Net with Attention for Multi-channel Multi-touch Attribution. 2018  
•	JDMTA: Causally Driven Incremental Multi Touch Attribution Using a Recurrent Neural Network. 2019  
•	CAMTA: Causal Attention Model for Multi-touch Attribution. 2020  
•	CausalMTA: Eliminating the User Confounding Bias for Causal Multi-touch Attribution. 2022  

## 一句话介绍
- **Data-driven MTA**
  - **是什么？**  
    第一次提出数据驱动的多触点归因模型。
  - **为什么？**  
    通过多触点归因，广告主可以量化评估各个渠道对转化的重要性，从而调整在各个渠道上的预算分配，实现全局角度的投放策略优化。
  - **怎么做？**  
    使用逻辑回归 + bagged 的组合方法。其中逻辑回归用于求每个触点的参数，bagged 方法能减少因高度相关的协变量而导致的估计变异性。

- **DNAMTA**
  - **是什么？**  
    利用触点序列信息的多触点归因模型。
  - **为什么？**  
    触点是一个序列，序列中触点的顺序、频率、发生时间以及触点间依赖性关系都会影响最终的结果。  
    对触点序列的建模，可以捕捉到过去的信息是如何积累并影响最终结果的。
  - **怎么做？**  
    LSTM 对触点序列进行学习，MLP 对用户静态信息进行学习，最终通过注意力机制获取触点权重。

- **JDMTA**
  - **是什么？**  
    除了构建多触点模型，JDMTA 将购买时由广告产生的增量分配给每个广告触点。
  - **为什么？**  
    由于用户自身的行为、偏好等等，本来就会有一定的购买倾向。  
    极端来说，无论如何都会发生的购买不应该将其结果分配给广告触点。  
    例：购买苹果手机后，需要购买充电器。
  - **怎么做？**  
    JDMTA 使用夏普利值在考虑触点顺序的情况下将转化的整体增量改进后分配给触点序列。

- **CAMTA**
  - **是什么？**  
    混杂问题：因果学习的概念。因为某种原因同时影响两个结果，并进而错误推断两个结果存在因果关系的问题被称为混杂。  
    广告混杂问题：广告场景下，用户的静态特征和历史行为也都会影响广告渠道和最终转化。  
    举个例子：某个用户，对苹果手机非常喜欢，打算购置最新的一款。他搜索该款手机，点击搜索结果中该款手机的广告并最终下单。并不能得到因为该款手机在搜索渠道向用户展示，从而导致用户下单购买的结论。因为，真实的情况是，搜索渠道的广告曝光和用户下单购买都是因为用户对该款手机感兴趣，即使没有广告曝光，用户仍会购买该款手机。
  - **为什么？**  
    用户看到的广告不是随机的。在这种有偏的情况下，无法准确的衡量此广告带来的收益。也无法准确得到用户最终是否会转化。  
    理想无偏情况下，每个触点、每个广告位的用户分布应该是随机的。这样得到的转化能够更准确的衡量。  
    例子：如下图所示，T1 和 T2 时刻，用户上下文 X1，X2 作为混杂因子，既影响这两个时刻用户是否发生转化（y），也影响了用户看到的广告（c）。
    <p align="center">
      <img width="432" height="225" alt="image" src="https://github.com/user-attachments/assets/53801330-9ddf-4fb8-add6-8dacf7ba002a" />
    </p>

  - **怎么做？**  
    在对触点做建模的时候，采用两个 loss function：  
    - 渠道预估的分类器经过 softmax 函数得到各渠道概率的预估值。  
    - 点击预估的分类器经过 Sigmoid 函数得到点击概率的预估值。  
    为了学到无偏估计，需要**最大化**渠道预估分类器的损失函数。  
    为了准确预估广告是否被点击，需要**最小化**点击预估分类器的损失函数。

- **CausalMTA**
  - **是什么？**  
    和 CAMTA 一样，CausalMTA 认为渠道序列中的混杂问题需要考虑。  
    CausalMTA 从静态属性和动态特征两个角度，系统性地消除了用户偏好这一混杂偏差。
  - **为什么？**  
    CausalMTA 认为广告中静态属性和动态特征的影响是相互独立的。其中，静态属性决定用户对于物品的兴趣，动态特征决定用户购买的可能性。  
    例：  
    - 大学生喜欢买时尚的手机，而中年人更喜欢高性价比的手机。这就是静态属性（年龄，性别，职业等等）。  
    - 看到广告的停留时间，反映了用户的购买意图。这就是动态特征。
  - **怎么做？**  
    - 对于静态属性，论文使用**变分循环自编码器**作为渠道序列生成模型获取它的无偏分布。之后，基于无偏分布和逆概率加权的方法对每个转化路径重加权，从而消除静态属性引起的选择偏差。  
    - 对于动态特征，其和 CAMTA 类似，也是借鉴 CRN，通过循环神经网络和域对抗训练，生成用户历史的无偏表征，从而消除动态特征引起的选择偏差，得到无偏的转化率预估模型。  
    - 最后，基于转化率预估模型，采用反事实分析计算各渠道的夏普利值作为归因权重。

## 具体是怎么做的？
- 详情请见pdf。

